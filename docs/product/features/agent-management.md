<!-- Updated: 2025-02-13 | Sprint: - | Tasks: - -->

# Управление агентами

## Краткое описание

Система создания и управления AI-агентами, где каждый агент имеет уникальную роль, профиль навыков и набор skills для выполнения задач.

## Пользовательская ценность

**Как** руководитель проекта (boss),
**я хочу** создавать специализированных агентов под разные задачи,
**чтобы** эффективно распределять работу в команде.

## Основные сценарии использования

### Сценарий 1: Создание нового агента

1. Boss определяет потребность в новом специалисте
2. Boss описывает роль, навыки, зону ответственности
3. HR создаёт агента через `create_employee.py`
4. Агент появляется в `employees.json`
5. Оркестратор сразу видит нового агента
6. Boss может назначать агента на задачи

### Сценарий 2: Использование skills

1. Агент получает задачу
2. Агент читает свои skills из `.tayfa/{agent}/skills/`
3. Применяет методологии и шаблоны из skills
4. Выполняет задачу качественнее

### Сценарий 3: Выбор исполнителя для задачи

1. Boss анализирует задачу (тип, сложность, навыки)
2. Просматривает профили агентов
3. Выбирает подходящего по навыкам
4. Проверяет загрузку агента
5. Назначает на задачу

## Структура папки агента

```
.tayfa/{agent_name}/
├── prompt.md          # Системный промпт агента
├── profile.md         # Профиль: навыки, специализация
└── skills/            # Навыки агента
    ├── SKILL-xxx.md
    └── SKILL-yyy.md
```

## Ключевое поведение

| Ситуация | Поведение системы |
|----------|-------------------|
| Создание агента | Папка + prompt.md + profile.md + регистрация в employees.json |
| Запуск агента | Читает prompt.md, получает задачу, использует skills |
| Удаление агента | Удаление из employees.json (папка остаётся) |

## Роли агентов

| Агент | Модель | Основная роль | Типичные задачи |
|-------|--------|---------------|-----------------|
| boss | opus | Руководитель | Создание задач, контроль, принятие решений |
| analyst | sonnet | Постановщик | Детализация требований, acceptance criteria |
| developer | sonnet | Разработчик | Написание кода, реализация фич |
| tester | haiku | Тестировщик | Проверка качества, баг-репорты |
| hr | sonnet | HR-менеджер | Создание новых агентов |
| process_architect | opus | Архитектор процессов | Оптимизация workflow |

## Модели агентов

| Модель | Стоимость | Использование |
|--------|-----------|---------------|
| **opus** | Высокая | Стратегические роли (boss, architect) — глубокий анализ |
| **sonnet** | Средняя | Рабочие роли (analyst, developer) — баланс цены/качества |
| **haiku** | Низкая | Рутинные задачи (tester) — работа по чек-листам |

## Skills (навыки)

### Что такое skills

Файлы `SKILL-*.md` содержат:
- Методологии работы
- Шаблоны и чек-листы
- Лучшие практики
- Пошаговые инструкции

### Примеры skills

```
.tayfa/boss/skills/
├── SKILL-task-decomposer.md     # Декомпозиция задач
├── SKILL-team-assignment.md     # Назначение исполнителей
└── SKILL-project-tracking.md    # Отслеживание прогресса

.tayfa/process_architect/skills/
├── SKILL-process-design.md      # Проектирование процессов
├── SKILL-agent-optimizer.md     # Оптимизация агентов
└── SKILL-task-structure.md      # Структура задач
```

### Правило использования

Агент **обязан** использовать свои skills при выполнении задач. Skills содержат проверенные методологии, которые повышают качество работы.

## Ограничения и особенности

- Реестр агентов: только `employees.json`
- Новые агенты: только через `create_employee.py`
- Boss не редактирует employees.json вручную
- Каждый агент имеет фиксированную модель (opus/sonnet/haiku)

## Связанные компоненты

- `.tayfa/common/employees.json` — реестр агентов
- `.tayfa/common/employee_manager.py` — CLI управления
- `.tayfa/hr/create_employee.py` — создание агентов
- `.tayfa/{agent}/prompt.md` — системный промпт
- `.tayfa/{agent}/profile.md` — профиль
- `.tayfa/{agent}/skills/` — навыки

## CLI команды

```bash
# Список агентов
python .tayfa/common/employee_manager.py list

# Создание агента
python .tayfa/hr/create_employee.py {name} --model sonnet
```

## История изменений

| Дата | Спринт | Что изменилось |
|------|--------|----------------|
| 2025-02-13 | - | Первоначальная версия. Добавлено описание skills |
