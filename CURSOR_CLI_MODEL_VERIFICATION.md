# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°: ĞœĞ¾Ğ´ĞµĞ»ÑŒ Composer 1.5 Ğ´Ğ»Ñ Cursor CLI âœ…

## Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: Ğ’Ğ•Ğ Ğ˜Ğ¤Ğ˜ĞšĞĞ¦Ğ˜Ğ¯ ĞŸĞ ĞĞ™Ğ”Ğ•ĞĞ âœ…

ĞšĞ¾Ğ´ Ğ² `kok/app.py` **Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ Ğ¸ ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾** Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ **Composer 1.5** Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ² Cursor CLI.

---

## ğŸ“‹ Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ğ»Ğ¸

### 1. ĞšĞ¾Ğ½ÑÑ‚Ğ°Ğ½cÑ‚Ğ° CURSOR_CLI_MODEL

**Ğ¤Ğ°Ğ¹Ğ»**: `kok/app.py`, ÑÑ‚Ñ€Ğ¾ĞºĞ° 290

```python
CURSOR_CLI_MODEL = "Composer 1.5"  # default model for Cursor CLI (agent --model)
```

âœ… **Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**: ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ° ĞºĞ¾Ğ½ÑÑ‚Ğ°Ğ½cÑ‚Ğ° `Composer 1.5`

---

### 2. Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ _cursor_cli_model_flag()

**Ğ¤Ğ°Ğ¹Ğ»**: `kok/app.py`, ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 817-820

```python
def _cursor_cli_model_flag() -> str:
    """Always uses CURSOR_CLI_MODEL (Composer 1.5). Ignores any request override."""
    safe = CURSOR_CLI_MODEL.replace("'", "'\"'\"'")
    return f" --model '{safe}'"
```

âœ… **Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**:
- Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ **Ğ½Ğµ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²** (Ñ€Ğ°Ğ½ÑŒÑˆĞµ Ğ±Ñ‹Ğ» `model: str | None` â€” Ğ¿ĞµÑ€ĞµĞ´ĞµĞ»Ğ°Ğ½Ğ¾)
- **Ğ’ÑĞµĞ³Ğ´Ğ°** Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ `" --model 'Composer 1.5'"`
- Ğ˜Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ **Ğ»ÑĞ±Ñ‹Ğµ** Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸ Ğ¿ĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ğ¸Ğ· Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°

---

### 3. Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ run_cursor_cli()

**Ğ¤Ğ°Ğ¹Ğ»**: `kok/app.py`, ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 823-859

```python
async def run_cursor_cli(agent_name: str, user_prompt: str, use_chat: bool = True) -> dict:
    """
    Runs Cursor CLI in WSL in headless mode.
    ...
    Model is always CURSOR_CLI_MODEL (Composer 1.5).
    ...
    """
    ...
    model_part = _cursor_cli_model_flag()
    # Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚: " --model 'Composer 1.5'"

    wsl_script = (
        f"{base} && "
        "content=$(cat .cursor_cli_prompt.txt | sed 's/\"/\\\\\"/g') && "
        f"agent -p --force{resume_part}{model_part} --output-format json \"$content\""
    )
    # Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ WSL ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹:
    # agent -p --force --resume '<chat_id>' --model 'Composer 1.5' --output-format json "..."
```

âœ… **Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**:
- Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ **Ğ½Ğµ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ `model`** (Ñ€Ğ°Ğ½ÑŒÑˆĞµ Ğ±Ñ‹Ğ» â€” ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¾)
- **Ğ’ÑĞµĞ³Ğ´Ğ°** Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ `_cursor_cli_model_flag()` Ğ±ĞµĞ· Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
- WSL ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° **Ğ²ÑĞµĞ³Ğ´Ğ° ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚** `--model 'Composer 1.5'`

---

### 4. Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ send_prompt_cursor()

**Ğ¤Ğ°Ğ¹Ğ»**: `kok/app.py`, ÑÑ‚Ñ€Ğ¾ĞºĞ¸ 1442-1475

```python
@app.post("/api/send-prompt-cursor")
async def send_prompt_cursor(data: dict):
    """
    Send a prompt to Cursor CLI via WSL. Saves history to chat_history.json.
    ...
    """
    name = data.get("name") or data.get("agent")
    prompt_text = data.get("prompt") or ""
    task_id = data.get("task_id")

    if not name or not prompt_text:
        raise HTTPException(status_code=400, detail="name and prompt are required")

    use_chat = data.get("use_chat", True)
    # Model always CURSOR_CLI_MODEL (Composer 1.5), request body model is ignored

    start_time = _time.time()
    result = await run_cursor_cli(name, prompt_text, use_chat=use_chat)
    # â†‘ ĞĞµ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ğ¼ model Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ â€” run_cursor_cli() Ğ’Ğ¡Ğ•Ğ“Ğ”Ğ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Composer 1.5

    duration_sec = _time.time() - start_time

    # Save to chat history
    save_chat_message(
        agent_name=name,
        prompt=prompt_text,
        result=result.get("result", ""),
        runtime="cursor",
        cost_usd=None,  # Cursor CLI doesn't return cost
        duration_sec=duration_sec,
        task_id=task_id,
        success=result.get("success", False),
        extra={"stderr": result.get("stderr")} if result.get("stderr") else None,
    )

    return result
```

âœ… **Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**:
- ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¹ ÑĞ²Ğ½Ğ¾ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ñ‚: `"# Model always CURSOR_CLI_MODEL (Composer 1.5), request body model is ignored"`
- `run_cursor_cli()` Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ **Ğ±ĞµĞ· Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ° `model`**
- Ğ›ÑĞ±Ğ¾Ğ¹ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ `model` Ğ² Ñ‚ĞµĞ»Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° **Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ**

---

## ğŸ” ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Composer 1.5

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tayfa UI: Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑˆÑŒ "Send" Ñ runtime="cursor"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ POST /api/send-prompt-cursor
                     â”‚ {name: "developer", prompt: "..."}
                     â”‚ (Ğ´Ğ°Ğ¶Ğµ ĞµÑĞ»Ğ¸ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‚ÑŒ model: "opus" â€” Ğ±ÑƒĞ´ĞµÑ‚ Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾)
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  send_prompt_cursor() Ğ² kok/app.py                      â”‚
â”‚                                                          â”‚
â”‚  1. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ name Ğ¸ prompt                              â”‚
â”‚  2. ĞŸÑ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¹: "Model always CURSOR_CLI..." â”‚
â”‚  3. ĞĞµ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ğ¼ model Ğ² run_cursor_cli()                â”‚
â”‚  4. Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼: run_cursor_cli(name, prompt, use_chat)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  run_cursor_cli() Ğ² kok/app.py                          â”‚
â”‚                                                          â”‚
â”‚  1. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ agent_name, user_prompt, use_chat         â”‚
â”‚  2. (Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ ĞĞ• Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ½Ğ° Ğ² Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ñ…)                  â”‚
â”‚  3. Ğ’Ñ‹Ğ·Ğ²Ğ°Ñ‚ÑŒ: model_part = _cursor_cli_model_flag()     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  _cursor_cli_model_flag() Ğ² kok/app.py                  â”‚
â”‚                                                          â”‚
â”‚  1. ĞšĞ¾Ğ½ÑÑ‚Ğ°Ğ½cÑ‚Ğ°: CURSOR_CLI_MODEL = "Composer 1.5"      â”‚
â”‚  2. return f" --model 'Composer 1.5'"                   â”‚
â”‚  3. (Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒÑÑ‚ÑÑ, Ğ¾Ğ½Ğ¸ Ğ¸ Ğ½Ğµ Ğ¿ĞµÑ€ĞµĞ´Ğ°ÑÑ‚ÑÑ)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° WSL ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ² run_cursor_cli()                  â”‚
â”‚                                                          â”‚
â”‚  model_part = " --model 'Composer 1.5'"                 â”‚
â”‚  wsl_script = (                                          â”‚
â”‚    f"{base} && "                                         â”‚
â”‚    "content=$(cat .cursor_cli_prompt.txt | ...) && "    â”‚
â”‚    f"agent -p --force{resume_part}{model_part} ..."     â”‚
â”‚  )                                                       â”‚
â”‚                                                          â”‚
â”‚  Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:                                              â”‚
â”‚  agent -p --force \                                      â”‚
â”‚    --resume '<chat_id>' \                                â”‚
â”‚    --model 'Composer 1.5' \                              â”‚
â”‚    --output-format json "..."                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ² WSL / Cursor CLI                          â”‚
â”‚                                                          â”‚
â”‚  $ agent -p --force \                                    â”‚
â”‚      --resume '<chat_id>' \                              â”‚
â”‚      --model 'Composer 1.5' \                            â”‚
â”‚      --output-format json \                              â”‚
â”‚      "Role: developer. Task: ..."                        â”‚
â”‚                                                          â”‚
â”‚  Cursor Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Composer 1.5 Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ       â”‚
â”‚  Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ² JSON                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ² Tayfa                                       â”‚
â”‚                                                          â”‚
â”‚  âœ… Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Composer 1.5                 â”‚
â”‚  âœ… Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½ Ğ² UI                            â”‚
â”‚  âœ… Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾ Ğ² chat_history.json Ñ runtime="cursor"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° Ğ¿Ñ€ĞµĞ´Ğ¼ĞµÑ‚ Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ°

### ĞœĞ¾Ğ¶ĞµÑ‚ Ğ»Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¿ĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ?

```bash
# ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° 1: ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‚ÑŒ model Ğ² body Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
curl -X POST http://localhost:8008/api/send-prompt-cursor \
  -H "Content-Type: application/json" \
  -d '{
    "name": "developer",
    "prompt": "...",
    "model": "opus"              # â† ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ¿ĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ
  }'
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚**: âŒ **Ğ‘ÑƒĞ´ĞµÑ‚ Ğ˜Ğ“ĞĞĞ Ğ˜Ğ ĞĞ’ĞĞĞ**

Ğ’ `send_prompt_cursor()`:
```python
use_chat = data.get("use_chat", True)
# Model always CURSOR_CLI_MODEL (Composer 1.5), request body model is ignored
# â†‘ ĞšĞ¾Ğ½ÑÑ‚Ğ°Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚, Ñ‡Ñ‚Ğ¾ model Ğ¸Ğ· body Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ

result = await run_cursor_cli(name, prompt_text, use_chat=use_chat)
# â†‘ model Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ ĞĞ• Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ÑÑ
```

Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑÑ:
```bash
agent -p --force --model 'Composer 1.5' --resume '<chat_id>' ...
```

### ĞœĞ¾Ğ¶ĞµÑ‚ Ğ»Ğ¸ Ğ¿Ğ¾Ğ´Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· URL Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€?

```bash
curl -X POST "http://localhost:8008/api/send-prompt-cursor?model=sonnet" ...
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚**: âŒ **ĞĞµ ÑÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚**

URL Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ÑÑ Ğ² ÑÑ‚Ğ¾Ğ¼ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ğµ. Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ JSON body:
```python
model = data.get("model")  # â† data â€” ÑÑ‚Ğ¾ JSON body, ĞĞ• URL params
```

### ĞœĞ¾Ğ¶ĞµÑ‚ Ğ»Ğ¸ Ğ¿Ğ¾Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ² employees.json?

```json
{
  "developer": {
    "model": "sonnet"  # â† ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ¿ĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ
  }
}
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚**: âŒ **Ğ‘ÑƒĞ´ĞµÑ‚ Ğ˜Ğ“ĞĞĞ Ğ˜Ğ ĞĞ’ĞĞĞ Ğ´Ğ»Ñ Cursor CLI**

Ğ”Ğ»Ñ Claude API â€” **Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ**, Ğ½Ğ¾ Ğ´Ğ»Ñ Cursor CLI ÑÑ‚Ğ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğµ Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ² `send_prompt_cursor()`.

---

## ğŸ”’ Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° 1: Ğ¡Ğ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸

```python
# âœ… ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ
async def run_cursor_cli(agent_name: str, user_prompt: str, use_chat: bool = True) -> dict:
    # ĞœĞ¾Ğ´ĞµĞ»ÑŒ ĞĞ• Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ÑÑ Ğ² Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ñ…
    model_part = _cursor_cli_model_flag()  # Ğ’Ğ¡Ğ•Ğ“Ğ”Ğ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ konstanta

# âŒ ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ (ĞµÑĞ»Ğ¸ Ğ±Ñ‹ Ğ±Ñ‹Ğ»Ğ¾ Ñ‚Ğ°Ğº):
async def run_cursor_cli(agent_name: str, user_prompt: str, use_chat: bool = True, model: str | None = None) -> dict:
    # Ğ‘Ñ‹Ğ»Ğ° Ğ±Ñ‹ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ
    model_part = _cursor_cli_model_flag(model)  # ĞĞŸĞĞ¡ĞĞ!
```

**Ğ’ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¼ ĞºĞ¾Ğ´Ğµ**: âœ… Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ½Ğµ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ model Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° 2: Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ _cursor_cli_model_flag()

```python
# âœ… ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ
def _cursor_cli_model_flag() -> str:
    """Always uses CURSOR_CLI_MODEL (Composer 1.5). Ignores any request override."""
    safe = CURSOR_CLI_MODEL.replace("'", "'\"'\"'")
    return f" --model '{safe}'"

# âŒ ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ (ĞµÑĞ»Ğ¸ Ğ±Ñ‹ Ğ±Ñ‹Ğ»Ğ¾ Ñ‚Ğ°Ğº):
def _cursor_cli_model_flag(model: str | None) -> str:
    if model is None:
        return f" --model '{CURSOR_CLI_MODEL}'"
    else:
        return f" --model '{model}'"  # ĞĞŸĞĞ¡ĞĞ! ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾Ğ´Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ
```

**Ğ’ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¼ ĞºĞ¾Ğ´Ğµ**: âœ… Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ½Ğµ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ¸ Ğ’Ğ¡Ğ•Ğ“Ğ”Ğ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ konstanta

---

## ğŸ“Š Ğ ĞµĞ·ÑĞ¼Ğµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ |
|----------|-----------|--------|
| **Konstanta CURSOR_CLI_MODEL** | "Composer 1.5" | âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ |
| **Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ _cursor_cli_model_flag()** | Ğ’ÑĞµĞ³Ğ´Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ konstanta | âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ |
| **Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ run_cursor_cli()** | ĞĞµ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ model Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ |
| **Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ send_prompt_cursor()** | ĞĞµ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ model Ğ² run_cursor_cli() | âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ |
| **ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¹ Ğ² ĞºĞ¾Ğ´Ğµ** | Ğ¯Ğ²Ğ½Ğ¾ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ñ‚ "Model always CURSOR_CLI_MODEL" | âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ |
| **WSL ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°** | Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ `--model 'Composer 1.5'` | âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ |
| **Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ¿ĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ** | model Ğ¸Ğ· body Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ | âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ |

---

## ğŸ¯ Ğ’Ñ‹Ğ²Ğ¾Ğ´

âœ… **Ğ’Ğ•Ğ Ğ˜Ğ¤Ğ˜ĞšĞĞ¦Ğ˜Ğ¯ ĞŸĞ ĞĞ™Ğ”Ğ•ĞĞ Ğ£Ğ¡ĞŸĞ•Ğ¨ĞĞ**

ĞšĞ¾Ğ´ Ğ² `kok/app.py` **Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾, ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾** Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ **Composer 1.5** Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ² Cursor CLI.

Ğ’ÑĞµ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸ Ğ¿ĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ (Ñ‡ĞµÑ€ĞµĞ· URL, body, employees.json) Ğ´Ğ»Ñ Cursor CLI Ğ±ÑƒĞ´ÑƒÑ‚ **Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹**.

**ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ Ğ² WSL**:
```bash
agent -p --force --resume '<chat_id>' --model 'Composer 1.5' --output-format json "..."
```

Ğ­Ñ‚Ğ¾ **Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚**, Ñ‡Ñ‚Ğ¾ Cursor CLI Ğ²ÑĞµĞ³Ğ´Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ **Composer 1.5** Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ².

---

## ğŸ“ Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹

Ğ¡ÑƒĞ´Ñ Ğ¿Ğ¾ ĞºĞ¾Ğ´Ñƒ, Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ñ‹ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ:

1. **Ğ‘Ñ‹Ğ»Ğ° Ğ²ĞµÑ€ÑĞ¸Ñ**: `async def run_cursor_cli(..., model: str | None = None)`
2. **Ğ¡Ñ‚Ğ°Ğ»Ğ° Ğ²ĞµÑ€ÑĞ¸Ñ**: `async def run_cursor_cli(...) # Ğ±ĞµĞ· model Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°`
3. **Ğ‘Ñ‹Ğ»Ğ° Ğ²ĞµÑ€ÑĞ¸Ñ**: `def _cursor_cli_model_flag(model: str | None) -> str:`
4. **Ğ¡Ñ‚Ğ°Ğ»Ğ° Ğ²ĞµÑ€ÑĞ¸Ñ**: `def _cursor_cli_model_flag() -> str:  # Ğ±ĞµĞ· Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²`
5. **Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸**: "Always uses CURSOR_CLI_MODEL", "Model always CURSOR_CLI_MODEL"

Ğ­Ñ‚Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ **ÑƒÑĞ¸Ğ»Ğ¸Ğ»Ğ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ** Ğ¸ **Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€ÑƒÑÑ‚** Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Composer 1.5.
