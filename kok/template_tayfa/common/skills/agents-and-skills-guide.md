# Краткое руководство: создание агентов и навыки сотрудников

## Как создаётся агент в приложении

1. **Подготовка папки сотрудника**
   В `Personel/<имя>/` создаётся структура:
   - `prompt.md` — системный промпт (роль, инструкции)
   - `profile.md` — профиль: роль, **навыки**, зона ответственности
   - при необходимости `skills.md` — расширенное описание навыков
   - `tasks.md`, `notes.md`, `source.md`, папки `income/`, `done/`, `request/`

2. **Регистрация агента через API**
   В `Personel/Request/` кладётся JSON (или оркестратор отправляет запрос). Можно явно указать **use_skills** — массив имён skills из папки `Tayfa/skills/` (см. ниже):
   ```json
   {
     "name": "имя_сотрудника",
     "system_prompt_file": "Personel/имя_сотрудника/prompt.md",
     "workdir": "/mnt/c/Cursor/Tayfa",
     "allowed_tools": "Read Edit Bash",
     "use_skills": ["project-decomposer"]
   }
   ```
   Отправляется **POST** на `http://localhost:8788/run` **без поля `prompt`** — это запрос на создание/обновление агента.

3. **Сборка системного промпта**
   Оркестратор (или API при вызове с `system_prompt_file`) при создании/обновлении агента:
   - читает `Personel/<имя>/prompt.md`;
   - читает `Personel/<имя>/profile.md` и при наличии — `Personel/<имя>/skills.md`;
   - подставляет блок «Навыки» из профиля (и из `skills.md`) в промпт и передаёт собранный текст как системный промпт агента.

4. **Кто создаёт агентов**
   Новых сотрудников онбордит **HR**: по описанию из `Personel/Income/` создаёт папку, заполняет `profile.md` (в т.ч. навыки), при необходимости `skills.md`, и добавляет запись в `Personel/Request/`. Создание агента в API выполняет оркестратор по этим данным. К **hr** с запросами по кадрам обращается только **boss**.

---

## Как правильно добавлять skills к сотрудникам

- **Основной источник навыков** — секция **«## Навыки»** в `Personel/<имя>/profile.md`.
  Оркестратор подставляет её в системный промпт при создании/обновлении агента.

- **Опционально** — файл `Personel/<имя>/skills.md` для детализации (уровни, чеклисты, ссылки).
  Если он есть, оркестратор подставляет и его. В `profile.md` в блоке «Навыки» можно написать: «См. skills.md».

- **Не дублировать** список навыков в `prompt.md` — навыки берутся только из `profile.md` и при наличии из `skills.md`.

- **Когда добавлять/менять навыки:**
  1. **Онбординг** — HR при создании сотрудника заполняет «Навыки» в `profile.md` (и при необходимости создаёт `skills.md`) по описанию из `Personel/Income/`.
  2. **Обновление** — boss или hr дают задание в `income/`; ответственный правит `profile.md` (и при необходимости `skills.md`).

- **Правила для HR и boss:**
  При онбординге обязательно заполнять секцию «Навыки» в `profile.md`. При смене роли или зоны ответственности обновлять и навыки в `profile.md`.

После изменения `profile.md` или `skills.md` следующий вызов агента (или пересборка промпта через API) уже подставит актуальные навыки — отдельно «применять» их не нужно.

---

## Явное подключение skills (Tayfa/skills)

Все **Cursor Agent Skills** хранятся в **Tayfa/skills/** — каждая подпапка (например `project-decomposer`, `team-role-analyzer` или `public/pptx`) содержит файл `SKILL.md`.

При создании агента или при отправке промпта через оркестратор можно указать, какие skills подключить к агенту:

```json
{
  "name": "developer_python",
  "prompt": "Create a presentation about our API architecture",
  "use_skills": ["public/pptx"]
}
```

При создании агента в JSON запроса добавь поле **use_skills** — массив идентификаторов (имён папок в `Tayfa/skills/`). Оркестратор прочитает соответствующие `SKILL.md` и добавит их содержимое в системный промпт агента. Поддерживаются вложенные пути, например `"public/pptx"` → `Tayfa/skills/public/pptx/SKILL.md`.
