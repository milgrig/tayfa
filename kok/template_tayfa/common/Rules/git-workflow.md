# Git Workflow для Tayfa

## 1. Первоначальная настройка (один раз)

Перед работой с Git пользователь настраивает в **Настройки → Git / GitHub**:
- `userName` — имя для коммитов
- `userEmail` — email для коммитов
- `defaultBranch` — основная ветка (main)
- `githubToken` — Personal Access Token с правами `repo`

## 2. Подключение проекта к Git

При открытии проекта возможны варианты:

| Состояние | Действие |
|-----------|----------|
| Нет `.git` | Спросить: «Вести проект в Git?» → Да: `git init` + настройка remote |
| Есть `.git`, нет remote | Спросить: «Указать GitHub репозиторий?» |
| Есть `.git` и remote | Готов к работе |
| Отказ от Git | Работать без Git, не спрашивать повторно |

**Создание репозитория:**
- Имя репозитория = имя проекта (или ввод пользователя)
- Remote URL: `https://github.com/{user}/{repo}.git`
- Ветка по умолчанию: `main`

## 3. Workflow спринта

```
main (стабильная версия)
  │
  └── sprint/S001 (ветка спринта)
        │
        ├── коммит: T001 — описание
        ├── коммит: T002 — описание
        ├── коммит: T003 — описание
        └── финализация → merge в main + tag vX.Y.Z
```

### 3.1 Начало спринта
```bash
git checkout main
git pull origin main
git checkout -b sprint/S001
```

### 3.2 Работа над задачей
После завершения задачи:
```bash
git add <файлы>
git commit -m "T001: Краткое описание задачи"
git push origin sprint/S001
```

### 3.3 Финализация спринта
Последняя задача спринта — «Финализация»:
1. Убедиться что все тесты проходят
2. Merge в main:
```bash
git checkout main
git merge sprint/S001 --no-ff -m "Merge sprint S001"
git tag -a vX.Y.Z -m "Release vX.Y.Z"
git push origin main --tags
```
3. Удалить ветку спринта (опционально)

## 4. Соглашения

### Формат коммитов
```
T001: Краткое описание (до 50 символов)

Детальное описание если нужно.
```

### Именование веток
- `main` — стабильная версия
- `sprint/S001` — ветка спринта
- `feature/T001-название` — фича-ветка (опционально)
- `fix/T002-название` — багфикс (опционально)

### Теги версий
- Формат: `vMAJOR.MINOR.PATCH` (например `v0.2.0`)
- Создаются при финализации спринта
- Автоинкремент настраивается в settings.json

## 5. API endpoints

| Endpoint | Описание |
|----------|----------|
| `POST /api/git/init` | Инициализация + настройка remote |
| `POST /api/git/commit` | Коммит изменений |
| `POST /api/git/push` | Push в remote |
| `POST /api/git/release` | Финализация: merge + tag + push |
| `GET /api/git/status` | Статус репозитория |

## 6. Флаг отказа от Git

Если пользователь отказался от Git:
- Сохранить в `config.json` проекта: `"useGit": false`
- Не показывать Git-функции в UI
- Не спрашивать повторно
